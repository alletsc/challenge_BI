Fonte = Csv.Document(File.Contents("C:\Projects\Data Science\alura-challenge-bi\week-01\data\Tabela - Pedidos.CSV"),[Delimiter=";", Columns=11, Encoding=65001, QuoteStyle=QuoteStyle.None]),
    #"Cabeçalhos Promovidos" = Table.PromoteHeaders(Fonte, [PromoteAllScalars=true]),
    #"Tipo Alterado com Localidade1" = Table.TransformColumnTypes(#"Cabeçalhos Promovidos", {{"Latitude", type number}}, "en-US"),
    #"Tipo Alterado com Localidade" = Table.TransformColumnTypes(#"Tipo Alterado com Localidade1", {{"Longitude", type number}}, "en-US"),
    #"Colunas Renomeadas" = Table.RenameColumns(#"Tipo Alterado com Localidade",{{"UF da entrega", "UF da Entrega"}}),
    #"Dividir Coluna por Delimitador" = Table.SplitColumn(#"Colunas Renomeadas", "Data previsão", Splitter.SplitTextByDelimiter(" ", QuoteStyle.Csv), {"Data previsão.1", "Data previsão.2"}),
    #"Tipo Alterado" = Table.TransformColumnTypes(#"Dividir Coluna por Delimitador",{{"ID Pedido", Int64.Type}, {"ID Produto", Int64.Type}, {"Quantidade", Int64.Type}, {"ID Veículo", Int64.Type}, {"Status do pedido", type text}, {"Data da compra", type text}, {"Data de entrega", type datetime}, {"Data previsão.1", type date}, {"Data previsão.2", type time}, {"UF da Entrega", type text}}),
    #"Colunas Renomeadas1" = Table.RenameColumns(#"Tipo Alterado",{{"Data previsão.2", "Hora da Previsão de Entrega"}, {"Data previsão.1", "Data da Previsão de Entrega"}}),
    #"Dividir Coluna por Delimitador1" = Table.SplitColumn(Table.TransformColumnTypes(#"Colunas Renomeadas1", {{"Data de entrega", type text}}, "pt-BR"), "Data de entrega", Splitter.SplitTextByDelimiter(" ", QuoteStyle.Csv), {"Data de entrega.1", "Data de entrega.2"}),
    #"Tipo Alterado1" = Table.TransformColumnTypes(#"Dividir Coluna por Delimitador1",{{"Data de entrega.1", type date}, {"Data de entrega.2", type time}}),
    #"Colunas Renomeadas2" = Table.RenameColumns(#"Tipo Alterado1",{{"Data de entrega.2", "Hora da Entrega"}, {"Data de entrega.1", "Data de Entrega"}}),
    #"Dividir Coluna por Delimitador2" = Table.SplitColumn(#"Colunas Renomeadas2", "Data da compra", Splitter.SplitTextByDelimiter(" ", QuoteStyle.Csv), {"Data da compra.1", "Data da compra.2"}),
    #"Tipo Alterado2" = Table.TransformColumnTypes(#"Dividir Coluna por Delimitador2",{{"Data da compra.1", type text}, {"Data da compra.2", type time}}),
    #"Colunas Renomeadas3" = Table.RenameColumns(#"Tipo Alterado2",{{"Data da compra.2", "Hora da Compra"}, {"Data da compra.1", "Data da Compra"}}),
    #"Colocar Cada Palavra Em Maiúscula" = Table.TransformColumns(#"Colunas Renomeadas3",{{"Status do pedido", Text.Proper, type text}}),
    #"Tipo Alterado3" = Table.TransformColumnTypes(#"Colocar Cada Palavra Em Maiúscula",{{"ID Veículo", type text}, {"ID Produto", type text}, {"ID Pedido", type text}}),
    #"Tipo Alterado com Localidade2" = Table.TransformColumnTypes(#"Tipo Alterado3", {{"Data da Compra", type date}}, "en-US"),
    #"Erros Substituídos" = Table.ReplaceErrorValues(#"Tipo Alterado com Localidade2", {{"Data de Entrega", null}}),
    #"Erros Substituídos1" = Table.ReplaceErrorValues(#"Erros Substituídos", {{"Hora da Entrega", null}}),
    #"Colunas Renomeadas4" = Table.RenameColumns(#"Erros Substituídos1",{{"ID Produto", "ID do Produto"}, {"ID Pedido", "ID do Pedido"}, {"ID Veículo", "ID do Veículo"}}),
    #"Literal inserido" = Table.AddColumn(#"Colunas Renomeadas4", "País", each "Brasil", type text),
    #"Colunas Removidas" = Table.RemoveColumns(#"Literal inserido",{"País"}),
    #"Linhas Filtradas" = Table.SelectRows(#"Colunas Removidas", each true),
    #"Consultas Mescladas" = Table.NestedJoin(#"Linhas Filtradas", {"ID do Produto"}, Produtos, {"ID do Produto"}, "Produtos", JoinKind.LeftOuter),
    #"Produtos Expandido" = Table.ExpandTableColumn(#"Consultas Mescladas", "Produtos", {"ID do Produto", "Preço"}, {"Produtos.ID do Produto", "Produtos.Preço"}),
    #"Colunas Removidas1" = Table.RemoveColumns(#"Produtos Expandido",{"Produtos.ID do Produto"}),
    #"Colunas Renomeadas5" = Table.RenameColumns(#"Colunas Removidas1",{{"Produtos.Preço", "Preço"}}),
    #"Personalização Adicionada" = Table.AddColumn(#"Colunas Renomeadas5", "Faturamento", each [Quantidade] * [Preço]),
    #"Tipo Alterado4" = Table.TransformColumnTypes(#"Personalização Adicionada",{{"Faturamento", Currency.Type}})
in
    #"Tipo Alterado4"